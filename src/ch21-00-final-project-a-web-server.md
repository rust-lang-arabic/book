# المشروع النهائي: بناء خادوم ويب متعدد الخيوط (Final Project: Building a Multithreaded Web Server)

لقد كانت رحلة طويلة، ولكننا وصلنا إلى نهاية الكتاب. في هذا الفصل، سنبني مشروعًا آخر معًا لنوضح بعض المفاهيم التي غطيناها في الفصول الأخيرة، بالإضافة إلى تلخيص بعض الدروس السابقة.

لمشروعنا النهائي، سنصنع خادوم ويب (web server) يقول "Hello!" ويبدو مثل الشكل 21-1 في متصفح الويب.

فيما يلي خطتنا لبناء خادوم الويب (web server):

1. تعلم قليلاً عن TCP و HTTP.
2. الاستماع لاتصالات TCP على مقبس (socket).
3. تحليل (parse) عدد صغير من طلبات HTTP.
4. إنشاء استجابة HTTP مناسبة.
5. تحسين الإنتاجية (throughput) لخادومنا باستخدام مجمع خيوط (thread pool).

<img alt="Screenshot of a web browser visiting the address 127.0.0.1:8080 displaying a webpage with the text content "Hello! Hi from Rust"" src="img/trpl21-01.png" class="center" style="width: 50%;" />

<span class="caption">الشكل 21-1: مشروعنا النهائي المشترك</span>

قبل أن نبدأ، يجب أن نذكر تفصيلتين. أولاً، الطريقة التي سنستخدمها لن تكون أفضل طريقة لبناء خادوم ويب (web server) باستخدام Rust. نشر أعضاء المجتمع عددًا من الحزم (crates) الجاهزة للإنتاج المتاحة على [crates.io](https://crates.io/) والتي توفر تطبيقات أكثر اكتمالاً لخادوم الويب ومجمع الخيوط (thread pool) مما سنبنيه. ومع ذلك، فإن نيتنا في هذا الفصل هي مساعدتك على التعلم، وليس اتخاذ الطريق السهل. نظرًا لأن Rust هي لغة برمجة أنظمة (systems programming language)، يمكننا اختيار مستوى التجريد (level of abstraction) الذي نريد العمل به ويمكننا الذهاب إلى مستوى أدنى مما هو ممكن أو عملي في لغات أخرى.

ثانيًا، لن نستخدم async و await هنا. بناء مجمع خيوط (thread pool) هو تحدٍ كبير بما فيه الكفاية بمفرده، دون إضافة بناء وقت تشغيل async (async runtime)! ومع ذلك، سنلاحظ كيف يمكن أن تنطبق async و await على بعض المشاكل نفسها التي سنراها في هذا الفصل. في النهاية، كما لاحظنا في الفصل 17، تستخدم العديد من أوقات تشغيل async (async runtimes) مجمعات الخيوط (thread pools) لإدارة عملها.

لذلك سنكتب خادوم HTTP الأساسي ومجمع الخيوط (thread pool) يدويًا حتى تتمكن من تعلم الأفكار والتقنيات العامة وراء الحزم (crates) التي قد تستخدمها في المستقبل.
